<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap 4 CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

	<!-- font-awesome CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">  
    
    <!-- Date Time Picker CSS -->
    <link rel="stylesheet" href="../css/bootstrap-datetimepicker.min.css">
    
    <!-- Custom styles for this template -->
    <link href="../css/product.css" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    
<title>Welcome</title>
</head>
<body>
    <nav class="navbar navbar-expand-md navbar-light bg-light">
      <a class="navbar-brand" href="#">
      	<img src="../img/logo.png" width="80" height="40" alt="">
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#">Book a service<span class="sr-only">(current)</span></a>
          </li>

        </ul>
        <form class="form-inline my-2 my-lg-0">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Sign in</button>
        </form>
      </div>
    </nav>
 
     <div class="position-relative overflow-hidden p-3 p-md-5 m-md-3 text-center bg-light">
      <div class="col-md-5 p-lg-5 mx-auto my-5">
        <h1 class="display-4 font-weight-normal">Vehicle Inspection</h1>
        <p class="lead font-weight-normal">With Over 10 Years of Integrity in the Motor Vehicle Industry</p>
        <a class="btn btn-outline-secondary" href="#make-an-appointment">MAKE AN APPOINTMENT</a>
      </div>
    </div>
 
   
	<div class="container" id="make-an-appointment">
		
		    <div class="d-md-flex flex-md-equal w-100 my-md-3 pl-md-3">
		      <div class="bg-light mr-md-3 pt-3 px-3 pt-md-5 px-md-5">

				    <form action="#" th:action="@{/save}" th:object="${appointment}" method="post">
		
						<div class="form-group row">
							<div class="col-lg-8">
								<select class="form-control" id="vClass" th:field="*{vehicleClassId.vehicleClassID}" required>
									<option value="" selected>Vehicle Type</option>
									<option th:each="veclss : ${veclss}" th:value="${veclss.vehicleClassID}" th:text="${veclss.vehicleClass}"></option>
								</select>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-lg-8">
								<select class="form-control" id="testCat" th:field="*{categoryId.categoryId}" required>
									<option value="" selected>Test Type</option>
									<option th:each="cat : ${testCategory}" th:value="${cat.categoryId}" th:text="${cat.categoryType}"></option>
								</select>
							</div>
						</div>		    
			
						<div class="form-group row">
						    <div class='col-sm-8'>
			<!-- 			        <input type='text' class="form-control" id='datetimepicker1' /> -->
					            <div class="form-group">
					                <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
					                    <input type="text" class="form-control datetimepicker-input" data-target="datetimepicker1" 
					                    	th:field="*{appointmentDate}" placeholder="Select a date..." required/>
					                    	
					                    <div class="input-group-append" data-target="datetimepicker1" data-toggle="datetimepicker">
					                        <div class="input-group-text"><i class="fa fa-calendar"></i></div>
					                    </div>
					                </div>
					            </div>
						    </div>
						    <div class='col-sm-4'>
						    	<input type="button" class="btn btn-primary" value="Check Availability" onclick="getFreeTimes()">
						    </div>
						</div>
			
						<div class="form-group row">
						    <div class='col-sm'>
					           	<div class="btn-group-toggle" data-toggle="buttons" id="timeSlots">
								</div>
						    </div>
						</div>
						<div class="form-group row">
							<div class='col-sm-8'>
								<input type="text" class="form-control" placeholder="Enter your name..." th:field="*{cusName}" required/>
							</div>
						</div>
						<div class="form-group row">
							<div class='col-sm-8'>
								<input type="text" class="form-control" placeholder="License plate no..." th:field="*{vehicleNo}" required/>
							</div>
						</div>
						<div class="form-group row">
							<div class='col-sm-8'>
								<input type="text" class="form-control" placeholder="Telephone..." th:field="*{cusMobileNo}" required/>
							</div>
						</div>
						<div class="form-group row">
							<div class='col-sm-8'>
								<input type="email" class="form-control" placeholder="Email.." th:field="*{cusEmail}" required/>
							</div>
						</div>
						<div class="form-group row">
							<div class='col-sm'>
								<input type="submit" class="btn btn-success" value="Submit">
							</div>
						</div>
					</form>
		        
		      </div>
		      <div class="bg-light mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center overflow-hidden">
		        <div>
		          <h2 class="display-5">Make Your Appointment</h2>
		          <p class="lead">Online</p>
		        </div>
		        <div class="bg-white box-shadow mx-auto" style="border-radius: 21px 21px 0 0;">
		        	<p><b>How to</b></p>
		        	<p class="text-success"><b>Step 1</b></p>
		        	<p>Select a date and the time slot you wish to make a booking. Fill in your personal & service request information into the boxes. Then click on the SUBMIT button.</p>
		        	
		        	<p class="text-success"><b>Step 2</b></p>
		        	<p>You will receive an email with the appointment details. Our member too will call you to verify the booking so please ensure that correct details are given. If incorrect details are given then We will delete your appointment out of our system.</p>
		        	
		        </div>
		      </div>
		    </div>
			
	</div>
	
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
   
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.21.0/moment.min.js" type="text/javascript"></script>
<script src="../js/bootstrap-datetimepicker.min.js"></script>

        <script type="text/javascript">
            $(function () {
            	
                $('#datetimepicker1').datetimepicker({
                    //inline: true,
                    format: 'L',
                    minDate: moment(1, 'h')
                });

                $('#datetimepicker1').datetimepicker()
                .on( "dp.change", function() {
                	//getFreeTimes();
                })
                
            });
        </script>


<script>
function getFreeTimes()
{
	var catID = document.getElementById("testCat").value;
	var date = $('#datetimepicker1').datetimepicker('viewDate').format('DD-MM-YYYY');
	var date2 = $('#datetimepicker1').datetimepicker('viewDate').format('YYYY-MM-DD');
	
	if (catID == "" || date == "" ) {
        return;
	}
	else{
		$.ajax({
	    	type: 'GET',
	    	url: "viewFreeTimeSlots",
	    	data: {"catID" :catID,"selectedDate":date,"date2":date2},
		    success: function(data){
		    	 $('#timeSlots').empty();
	            for(var i=0; i<data.length; i++){
	            	if(data[i] != null){
        				option ="<label class='btn btn-success btn-sm mr-1 mb-1'><input type='radio' name='appointmentTime' autocomplete='off' value='"+data[i]+"'>"+data[i]+"</label>";
        				$('#timeSlots').append(option);
	            	}
	            	  	
	            }
		    },
		    error:function(){
		        alert("error");
		    }
	
		});
	}
}
</script>
<div th:if = "${success ==1}">    
	<script>
		Swal.fire(
			'Good job!',
			'Appointment request was successfully sent !',
			'success'
		)
	</script>
</div>

</body>
</html>